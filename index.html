<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Copa BlackoutRugby Nacional</title>
  <style>
    :root{ --bg:#0f172a; --panel:#111827; --muted:#94a3b8; --text:#e5e7eb; --accent:#22d3ee; --accent-2:#a78bfa; --ok:#34d399; --warn:#f59e0b; --danger:#f87171; --card:#0b1224; }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:linear-gradient(180deg,var(--bg),#0b1020 60%,#0a0f1a);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif}
    a{color:var(--accent)}
    .container{max-width:1100px;margin:0 auto;padding:24px}
    header{position:sticky;top:0;z-index:10;backdrop-filter:saturate(180%) blur(8px);background:rgba(8,13,25,.8); border-bottom:1px solid rgba(255,255,255,.06)}
    .nav{display:flex;gap:16px;align-items:center;justify-content:space-between;padding:12px 24px}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:36px;height:36px;border-radius:10px;background:radial-gradient(circle at 30% 30%, var(--accent), var(--accent-2));box-shadow:0 0 30px rgba(34,211,238,.4)}
    .brand h1{font-size:1.1rem;margin:0;letter-spacing:.5px}
    .menu{display:flex;gap:12px;flex-wrap:wrap}
    .menu a{padding:8px 12px;border-radius:999px;background:rgba(255,255,255,.06);text-decoration:none;color:var(--text);border:1px solid rgba(255,255,255,.08)}
    .menu a:hover{background:rgba(255,255,255,.1)}
    .hero{padding:64px 24px 24px}
    .hero .wrap{display:grid;grid-template-columns:1.2fr .8fr;gap:24px}
    .card{background:var(--card);border:1px solid rgba(255,255,255,.05);border-radius:16px;box-shadow:0 8px 30px rgba(0,0,0,.3);padding:20px}
    .title{font-size:clamp(28px,3vw,42px);margin:0 0 6px}
    .subtitle{margin:0;color:var(--muted)}
    .pill{display:inline-block;margin-top:12px;padding:6px 10px;border-radius:999px;background:rgba(34,211,238,.15);border:1px solid rgba(34,211,238,.3);color:#bff6ff;font-size:.9rem}
    .grid{display:grid;gap:16px}
    .grid.cols-2{grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}
    .grid.cols-3{grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
    h2{margin:0 0 10px;font-size:1.3rem}
    .muted{color:var(--muted)}
    .kpi{display:flex;gap:14px;align-items:center}
    .kpi .num{font-weight:700;font-size:1.4rem}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid rgba(255,255,255,.07);text-align:left}
    th{color:#bcd3ff;font-weight:600;background:rgba(255,255,255,.04)}
    tr:hover td{background:rgba(255,255,255,.02)}
    .badge{padding:3px 8px;border-radius:999px;font-size:.8rem;border:1px solid rgba(255,255,255,.2)}
    .badge.ok{background:rgba(52,211,153,.1);border-color:rgba(52,211,153,.35)}
    .badge.warn{background:rgba(245,158,11,.1);border-color:rgba(245,158,11,.35)}
    .footer{padding:24px;color:var(--muted);text-align:center}
    .cta{display:flex;gap:10px;flex-wrap:wrap}
    .cta input,.cta button, .cta select, .cta textarea{padding:10px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.08);background:#0b1224;color:#e5e7eb}
    .cta button{cursor:pointer;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#05111a;border:none;font-weight:700}
    .section{padding:24px}
    .two-col{display:grid;grid-template-columns:2fr 1fr;gap:24px}
    .note{background:rgba(34,211,238,.08);border:1px dashed rgba(34,211,238,.35);padding:12px;border-radius:12px}
    .small{font-size:.92rem}
    @media (max-width: 860px){ .hero .wrap{grid-template-columns:1fr} .two-col{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <header>
    <nav class="nav container">
      <div class="brand"><div class="logo" aria-hidden="true"></div><h1>Copa BlackoutRugby Nacional</h1></div>
      <div class="menu">
        <a href="#informacion">Informaci√≥n</a>
        <a href="#calendario">Calendario</a>
        <a href="#equipos">Equipos</a>
        <a href="#partidos">Partidos</a>
        <a href="#clasificacion">Clasificaci√≥n</a>
        <a href="#trofeos">Trofeos</a>
        <a href="#reglamento">Reglamento</a>
        <a href="#inscripciones">Inscripciones</a>
        <a href="#contacto">Contacto</a>
      </div>
    </nav>
  </header>

  <main>
    <section class="hero">
      <div class="container wrap">
        <div class="card">
          <p class="pill" id="datesPill">Temporada 59 ¬∑ Online</p>
          <h2 class="title" id="titol">Copa BlackoutRugby Nacional</h2>
          <p class="subtitle" id="subtitol">Torneo amistoso 4 equipos ¬∑ liga (12 jornadas) + final</p>
          <div class="grid cols-3" style="margin-top:16px">
            <div class="kpi card"><div><div class="num" id="kpiEquips">4</div><div class="muted">Equipos</div></div></div>
            <div class="kpi card"><div><div class="num" id="kpiPartits">14</div><div class="muted">Partidos totales*</div></div></div>
            <div class="kpi card"><div><div class="num" id="kpiPremi">üèÜüèÜ</div><div class="muted">Trofeos: campe√≥n y subcampe√≥n</div></div></div>
          </div>
          <p class="muted small" style="margin-top:8px">*12 jornadas de liga + final (y final de consolaci√≥n).</p>
          <div class="cta" style="margin-top:16px">
            <a href="#reglamento" class="badge warn">Leer reglamento</a>
            <a href="https://www.blackoutrugby.com/home.php" target="_blank" rel="noopener" class="badge">Sitio oficial Blackout Rugby</a>
          </div>
        </div>
        <div class="card">
          <label class="small" style="display:block;margin-bottom:6px"><input type="checkbox" id="adminToggle"> Modo admin (local)</label>
          <h2>Pr√≥ximo partido</h2>
          <div id="properPartit" class="muted">A√∫n no definido</div>
          <hr style="border-color:rgba(255,255,255,.06);margin:16px 0">
          <h2>√öltimos resultados</h2>
          <ul id="ultimsResultats" class="muted" style="padding-left:18px;margin:0"></ul>
        </div>
      </div>
    </section>

    <section id="informacion" class="section">
      <div class="container two-col">
        <div class="card">
          <h2>Informaci√≥n general</h2>
          <p>Temporada 59 ¬∑ Participan 4 equipos: <strong>Lokomot√≠va Ko≈°ice</strong>, <strong>C.P. Les Abelles</strong>, <strong>Amics de la Cervesa</strong> y <strong>Amics de la Pilsner Urquell</strong>.</p>
          <p>La liga consta de <strong>12 jornadas</strong>. Jornada 13: <strong>final</strong> (1¬∫ vs 2¬∫) y <strong>consolaci√≥n</strong> (3¬∫ vs 4¬∫). Dos trofeos: campe√≥n y subcampe√≥n.</p>
        </div>
        <div class="card">
          <h2>Requisitos BlackoutRugby</h2>
          <div class="note">
            <ul>
              <li>Debes tener un enlace en la p√°gina principal que apunte a <a href="https://www.blackoutrugby.com/home.php" target="_blank" rel="noopener">https://www.blackoutrugby.com/home.php</a>.</li>
              <li>Tu sitio <strong>no</strong> debe usar el logotipo de Blackout Rugby en el encabezado (logo del sitio).</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <section id="calendario" class="section">
      <div class="container">
        <div class="card">
          <h2>Calendario</h2>
          <p class="muted small">Mant√©n los resultados con <code>results.json</code> en el repo o temporalmente en tu navegador (modo admin).</p>
          <table id="taulaCalendari">
            <thead><tr><th>Jornada</th><th>Fecha</th><th>Fase</th><th>Partido</th><th>Marcador</th><th>Ensayos</th><th>Estado</th></tr></thead>
            <tbody></tbody>
          </table>
          <div id="adminPanel" style="display:none; margin-top:16px" class="note">
            <h3 style="margin:0 0 8px">Editor de datos (admin local)</h3>
            <div class="cta">
              <button id="btnExport">Descargar results.json</button>
              <button id="btnLoadRepo">Cargar desde results.json del repo</button>
            </div>
            <p class="small muted" style="margin:8px 0 4px">Pega aqu√≠ un JSON v√°lido para importar/editar:</p>
            <textarea id="jsonArea" rows="10" style="width:100%" placeholder='[{"jornada":1,"fase":"Liga","fecha":"2025-09-22 19:35","local":"Lokomot√≠va Ko≈°ice","visitante":"Amics de la Cervesa","pL":0,"pV":121,"tL":0,"tV":0,"estado":"finalizado"}]'></textarea>
            <div class="cta" style="margin-top:8px">
              <button id="btnImport">Importar JSON</button>
              <button id="btnGuardarLocal">Guardar en este navegador</button>
              <button id="btnReset">Resetear a plantilla</button>
            </div>
            <p class="small muted">Sugerencia: sube el fichero descargado como <code>results.json</code> a la ra√≠z del repo para hacerlo p√∫blico.</p>
          </div>
        </div>
      </div>
    </section>

    <section id="equipos" class="section">
      <div class="container">
        <div class="card">
          <h2>Equipos</h2>
          <div id="llistaEquips" class="grid cols-2"></div>
        </div>
      </div>
    </section>

    <section id="partidos" class="section">
      <div class="container">
        <div class="card">
          <h2>Partidos (liga)</h2>
          <div class="grid cols-2" id="partitsGrups"></div>
        </div>
        <div class="card" style="margin-top:16px">
          <h2>Eliminatorias</h2>
          <div id="bracket" class="grid cols-2"></div>
        </div>
      </div>
    </section>

    <section id="clasificacion" class="section">
      <div class="container">
        <div class="card">
          <h2>Clasificaci√≥n</h2>
          <div id="tablaClasificacion" class="grid cols-2"></div>
        </div>
      </div>
    </section>

    <section id="trofeos" class="section">
      <div class="container">
        <div class="card">
          <h2>Trofeos</h2>
          <ul>
            <li>üèÜ Campe√≥n: <span id="trofeoCampeon" class="muted">por decidir</span></li>
            <li>ü•à Subcampe√≥n: <span id="trofeoSub" class="muted">por decidir</span></li>
          </ul>
        </div>
      </div>
    </section>

    <section id="reglamento" class="section">
      <div class="container">
        <div class="card">
          <h2>Reglamento (adaptaci√≥n Copa Hisp√°nica)</h2>
          <p>Managers con equipos activos en Espa√±a (Blackout Rugby). Los equipos pueden jugar en cualquier pa√≠s.</p>
          <p>Se disputa con 4 equipos en temporada 59. Liga de 12 jornadas y jornada 13 con final (1¬∫ vs 2¬∫) y consolaci√≥n (3¬∫ vs 4¬∫). Dos trofeos: campe√≥n y subcampe√≥n. Partidos en el horario del amistoso del equipo local.</p>
          <h3 style="margin-top:12px">Puntuaci√≥n por partido</h3>
          <ul>
            <li>4 puntos por victoria, 2 por empate, 0 por derrota.</li>
            <li>+1 punto bonus por 4+ ensayos.</li>
            <li>+1 punto bonus por perder por 7 o menos.</li>
          </ul>
          <h3 style="margin-top:12px">Desempates</h3>
          <ol><li>Diferencia (PF ‚àí PC)</li><li>Mayor PF</li><li>Menor PC</li><li>Bonus por ensayos</li><li>Bonus por derrota</li><li>Sorteo</li></ol>
        </div>
      </div>
    </section>

    <section id="inscripciones" class="section">
      <div class="container two-col">
        <div class="card"><h2>Inscripciones</h2><p class="muted">Inscripciones cerradas para esta edici√≥n.</p></div>
        <div class="card"><h2>Lugar y horarios</h2><p class="muted">Online en BlackoutRugby ¬∑ CEST.</p><div style="height:220px;border-radius:12px;background:repeating-linear-gradient(45deg, rgba(255,255,255,.05), rgba(255,255,255,.05) 8px, rgba(255,255,255,.03) 8px, rgba(255,255,255,.03) 16px);"></div></div>
      </div>
    </section>

    <section id="contacto" class="section">
      <div class="container"><div class="card"><h2>Contacto</h2><p>Para dudas, escribe a <a href="mailto:organizacion@example.com">organizacion@example.com</a> o al chat del juego.</p></div></div>
    </section>
  </main>

  <footer class="footer">¬© <span id="any"></span> Copa BlackoutRugby Nacional ¬∑ Hecho con ‚ô• ¬∑ <a href="https://www.blackoutrugby.com/home.php" target="_blank" rel="noopener">Blackout Rugby</a></footer>

  <script>
  const CONFIG = {
    titol: "Copa BlackoutRugby Nacional",
    dates: "Temporada 59",
    tipus: "Liga (12 jornadas) + Final",
    equips: [
      { nom:"Lokomot√≠va Ko≈°ice", manager:"LOK", grup:"A", csr:300000 },
      { nom:"C.P. Les Abelles", manager:"CPA", grup:"A", csr:290000 },
      { nom:"Amics de la Cervesa", manager:"ADC", grup:"B", csr:285000 },
      { nom:"Amics de la Pilsner Urquell", manager:"APU", grup:"B", csr:280000 }
    ]
  };
  const STATE = { partidos: [] };
  async function cargarDesdeRepo(){
    try{
      const res = await fetch('results.json', {cache:'no-store'});
      if(!res.ok) throw new Error('no results.json');
      const data = await res.json();
      if(Array.isArray(data)) STATE.partidos = data; else throw new Error('formato inv√°lido');
    }catch(e){
      const local = localStorage.getItem('cbn_results');
      STATE.partidos = local ? JSON.parse(local) : [];
    }
  }
  const fmt = (s)=> s? new Date(s.replace(' ','T')+':00').toLocaleString('es-ES',{dateStyle:'medium', timeStyle:'short'}) : '‚Äî';
  function renderHero(){ document.getElementById('titol').textContent = CONFIG.titol; document.getElementById('datesPill').textContent = `${CONFIG.dates} ¬∑ Online`; document.getElementById('subtitol').textContent = `${CONFIG.equips.length} equipos ¬∑ ${CONFIG.tipus}`; document.getElementById('kpiEquips').textContent = CONFIG.equips.length; document.getElementById('kpiPartits').textContent = STATE.partidos.filter(p=>p.fase==='Liga').length + STATE.partidos.filter(p=>p.jornada===13).length; document.getElementById('any').textContent = new Date().getFullYear(); }
  function renderCalendario(){ const tbody = document.querySelector('#taulaCalendari tbody'); tbody.innerHTML = ''; [...STATE.partidos].sort((a,b)=> a.jornada===b.jornada ? (a.fase>b.fase?1:-1) : a.jornada-b.jornada).forEach(r=>{ const tr=document.createElement('tr'); const marcador=(r.pL!=null&&r.pV!=null)? `${r.pL} ‚Äì ${r.pV}`:'‚Äî'; const ensayos=(r.tL!=null&&r.tV!=null)? `${r.tL} ‚Äì ${r.tV}`:'‚Äî'; tr.innerHTML = `<td>${r.jornada}</td><td>${fmt(r.fecha)}</td><td>${r.fase}</td><td>${r.local} vs ${r.visitante}</td><td>${marcador}</td><td>${ensayos}</td><td>${r.estado}</td>`; tbody.appendChild(tr); }); }
  function renderEquipos(){ const cont = document.getElementById('llistaEquips'); cont.innerHTML=''; CONFIG.equips.forEach(e=>{ const div=document.createElement('div'); div.className='card'; div.innerHTML=`<h3 style="margin:0 0 4px">${e.nom}</h3><div class="muted">Manager: <strong>${e.manager}</strong> ¬∑ Grupo ${e.grup}</div>`; cont.appendChild(div); }); }
  function renderEliminatorias(){ const cont=document.getElementById('bracket'); cont.innerHTML=''; const fin=STATE.partidos.filter(p=> p.jornada===13).sort((a,b)=> a.fase>b.fase?1:-1); fin.forEach(p=>{ const div=document.createElement('div'); div.className='card'; div.innerHTML=`<h3 style="margin:0 0 8px">${p.fase}</h3>`; const tbl=document.createElement('table'); tbl.innerHTML=`<thead><tr><th>Fecha</th><th>Local</th><th></th><th>Visitante</th><th>Marcador</th><th>Estado</th></tr></thead>`; const tb=document.createElement('tbody'); const tr=document.createElement('tr'); const marcador=(p.pL!=null&&p.pV!=null)? `${p.pL} ‚Äì ${p.pV}`:'‚Äî'; tr.innerHTML=`<td>${fmt(p.fecha)}</td><td>${p.local}</td><td style="text-align:center">vs</td><td>${p.visitante}</td><td>${marcador}</td><td>${p.estado}</td>`; tb.appendChild(tr); tbl.appendChild(tb); div.appendChild(tbl); cont.appendChild(div); }); }
  function calcularClasificacion(){ const equipos=CONFIG.equips.map(e=> e.nom); const tabla=Object.fromEntries(equipos.map(n=> [n,{Equipo:n,PJ:0,PG:0,PE:0,PP:0,PF:0,PC:0,PB_ens:0,PB_der:0,Pts:0,Diff:0}])); const jugados=STATE.partidos.filter(p=> p.fase==='Liga' && p.estado==='finalizado' && p.pL!=null && p.pV!=null); jugados.forEach(p=>{ const L=tabla[p.local]; const V=tabla[p.visitante]; L.PJ++; V.PJ++; L.PF+=p.pL; L.PC+=p.pV; V.PF+=p.pV; V.PC+=p.pL; if(p.pL>p.pV){ L.PG++; V.PP++; L.Pts+=4; } else if(p.pL<p.pV){ V.PG++; L.PP++; V.Pts+=4; } else { L.PE++; V.PE++; L.Pts+=2; V.Pts+=2; } if(typeof p.tL==='number' && p.tL>=4){ L.PB_ens++; L.Pts++; } if(typeof p.tV==='number' && p.tV>=4){ V.PB_ens++; V.Pts++; } const dif=Math.abs(p.pL-p.pV); if(p.pL<p.pV && dif<=7){ L.PB_der++; L.Pts++; } if(p.pV<p.pL && dif<=7){ V.PB_der++; V.Pts++; } }); Object.values(tabla).forEach(r=> r.Diff=r.PF-r.PC); return Object.values(tabla).sort((a,b)=> b.Pts-a.Pts || b.Diff-a.Diff || b.PF-a.PF || a.PC-b.PC || b.PB_ens-a.PB_ens || b.PB_der-a.PB_der); }
  function renderClasificacion(){ const destino=document.getElementById('tablaClasificacion'); destino.innerHTML=''; const tabla=calcularClasificacion(); const card=document.createElement('div'); card.className='card'; const tbl=document.createElement('table'); tbl.innerHTML=`<thead><tr><th>Pos</th><th>Equipo</th><th>PJ</th><th>PG</th><th>PE</th><th>PP</th><th>PF</th><th>PC</th><th>Diff</th><th>PB ens.</th><th>PB der.</th><th>Puntos</th></tr></thead>`; const tb=document.createElement('tbody'); tabla.forEach((r,i)=>{ const tr=document.createElement('tr'); tr.innerHTML=`<td>${i+1}</td><td>${r.Equipo}</td><td>${r.PJ}</td><td>${r.PG}</td><td>${r.PE}</td><td>${r.PP}</td><td>${r.PF}</td><td>${r.PC}</td><td>${r.Diff}</td><td>${r.PB_ens}</td><td>${r.PB_der}</td><td><strong>${r.Pts}</strong></td>`; tb.appendChild(tr); }); tbl.appendChild(tb); card.appendChild(tbl); destino.appendChild(card); const fin=STATE.partidos.find(p=> p.fase==='Final' && p.estado==='finalizado'); if(fin){ document.getElementById('trofeoCampeon').textContent = fin.pL>fin.pV ? fin.local : (fin.pV>fin.pL ? fin.visitante : 'por decidir'); document.getElementById('trofeoSub').textContent = fin.pL>fin.pV ? fin.visitante : (fin.pV>fin.pL ? fin.local : 'por decidir'); } else { document.getElementById('trofeoCampeon').textContent = tabla[0]?.Equipo||'por decidir'; document.getElementById('trofeoSub').textContent = tabla[1]?.Equipo||'por decidir'; } }
  function renderProximoYUltimos(){ const futuros=STATE.partidos.filter(p=> p.estado==='pendiente'); const conFecha=futuros.filter(p=> p.fecha).map(p=> ({...p,cuando:new Date(p.fecha.replace(' ','T'))})).sort((a,b)=> a.cuando-b.cuando); const prox=conFecha[0] || futuros.sort((a,b)=> a.jornada-b.jornada)[0]; const div=document.getElementById('properPartit'); if(prox){ div.innerHTML=`<strong>${prox.local}</strong> vs <strong>${prox.visitante}</strong><br><span class="muted">${prox.fase} ¬∑ ${prox.fecha?fmt(prox.fecha):'Fecha por confirmar'}</span>`; } else { div.textContent='No hay partidos pendientes'; } const jugados=STATE.partidos.filter(p=> p.estado==='finalizado' && p.pL!=null && p.pV!=null); jugados.sort((a,b)=> (b.jornada-a.jornada) || (b.fase>a.fase?1:-1)); const ul=document.getElementById('ultimsResultats'); ul.innerHTML=''; if(jugados.length===0){ ul.innerHTML='<li>Todav√≠a no hay resultados.</li>'; return;} jugados.slice(0,5).forEach(p=>{ const li=document.createElement('li'); li.textContent = `${p.local} ${p.pL}-${p.pV} ${p.visitante} ¬∑ ${p.fase} ¬∑ ${p.fecha?fmt(p.fecha):'Fecha N/D'}`; ul.appendChild(li); }); }
  function bindAdmin(){ const toggle=document.getElementById('adminToggle'); const panel=document.getElementById('adminPanel'); toggle.addEventListener('change',()=>{ panel.style.display = toggle.checked? 'block':'none'; }); document.getElementById('btnExport').addEventListener('click',()=>{ const blob=new Blob([JSON.stringify(STATE.partidos,null,2)],{type:'application/json'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='results.json'; a.click(); URL.revokeObjectURL(a.href); }); document.getElementById('btnLoadRepo').addEventListener('click',async()=>{ await cargarDesdeRepo(); document.getElementById('jsonArea').value=JSON.stringify(STATE.partidos,null,2); renderAll(); }); document.getElementById('btnImport').addEventListener('click',()=>{ try{ const data=JSON.parse(document.getElementById('jsonArea').value); if(Array.isArray(data)){ STATE.partidos=data; renderAll(); alert('Datos importados'); } else alert('El JSON debe ser un array'); }catch(e){ alert('JSON inv√°lido'); } }); document.getElementById('btnGuardarLocal').addEventListener('click',()=>{ localStorage.setItem('cbn_results', JSON.stringify(STATE.partidos)); alert('Guardado en este navegador. Sube el results.json al repo para hacerlo p√∫blico.'); }); document.getElementById('btnReset').addEventListener('click',()=>{ STATE.partidos=[]; document.getElementById('jsonArea').value='[]'; renderAll(); }); }
  function renderAll(){ renderHero(); renderCalendario(); renderEliminatorias(); renderClasificacion(); renderProximoYUltimos(); }
  (async function(){ await cargarDesdeRepo(); renderEquipos(); bindAdmin(); renderAll(); })();
  </script>
</body>
</html>
